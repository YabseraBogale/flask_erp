{% extends "table.html" %}

{% block title %}

  <title>Budget Lisiting</title>

{% endblock %}

{% block listing_name %}

    Lisiting

{% endblock %}

{% block column %}

    <th>Item Name</th> 
    <th>Department</th>                                              
    <th>Item Buget</th>
    <th>Item Budget Deduct</th>
    <th>Item Quantity</th>
    <th>Item Quantity Deduct</th>
    <th>Item Unit</th>
    <th>Date From</th>
    <th>Date To</th>
{% endblock %}

{% block table_content %}
    {% for i in budget_list_name %}
        <tr>
            
            <td>
                {{i[0]}}
            </td>
            
            <td>
                {{i[1]}}
            </td>
            
            <td>
                {{i[2]}} {{i[6]}}
            </td>
            
            <td>
                {{i[3]}} {{i[6]}}
            </td>

            <td>
                {{i[4]}} 
            </td>
            
            <td>
                {{i[5]}}
            </td>

            <td>
                {{i[7]}}
            </td>
            
            <td>
                {{i[8]}}
            </td>

            <td>
                {{i[9]}}
            </td>
        </tr>

    {% endfor %}

{% endblock %}


{% block export_table %}
<p><button id="export_button">Export to Excel</button></p>
<script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
<script>
document.getElementById("export_button").addEventListener("click", function () {

	const table_html = document.getElementById("table");

	// Create a spreadsheet from the HTML table
	const workbook = XLSX.utils.table_to_book(table_html);

	// Trigger the download of the Excel file
	XLSX.writeFile(workbook, "employee_data.xlsx");

});
</script>
{% endblock %}
